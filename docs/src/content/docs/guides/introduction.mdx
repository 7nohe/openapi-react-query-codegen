---
title: Introduction
description: OpenAPI React Query Codegen is a code generator for creating React Query (also known as TanStack Query) hooks based on your OpenAPI schema.
---
import { Code, Tabs, TabItem, FileTree } from '@astrojs/starlight/components';

OpenAPI React Query Codegen is a code generator for creating React Query (also known as TanStack Query) hooks based on your OpenAPI schema.

## Features

- Generates custom react hooks that use React Query's `useQuery`, `useSuspenseQuery`, `useMutation` and `useInfiniteQuery` hooks
- Generates custom functions that use React Query's `ensureQueryData` and `prefetchQuery` functions
- Generates query keys and functions for query caching
- Generates pure TypeScript clients generated by [@hey-api/openapi-ts](https://github.com/hey-api/openapi-ts)
- Generates loader factories and helpers for [TanStack Router](https://tanstack.com/router) integration


## Installation

<Tabs>
  <TabItem label="npm">
    <Code code={`npm install -D @7nohe/openapi-react-query-codegen`} lang="bash"   />
  </TabItem>
  <TabItem label="yarn">
    <Code code={`yarn add -D @7nohe/openapi-react-query-codegen`} lang="bash"   />
  </TabItem>
  <TabItem label="pnpm">
    <Code code={`pnpm add -D @7nohe/openapi-react-query-codegen`} lang="bash"   />
  </TabItem>
</Tabs>


Register the command to the `scripts` property in your package.json file.

```json
{
  "scripts": {
    "codegen": "openapi-rq -i ./petstore.yaml"
  }
}
```

You can also run the command without installing it in your project using the npx command.

```bash
$ npx --package @7nohe/openapi-react-query-codegen openapi-rq -i ./petstore.yaml
```


## Usage

For example, let's generate React Query hooks for [the Petstore API](https://github.com/7nohe/openapi-react-query-codegen/blob/main/examples/petstore.yaml).

<Tabs>
  <TabItem label="npm">
    <Code code={`npm run codegen`} lang="bash"   />
  </TabItem>
  <TabItem label="yarn">
    <Code code={`yarn codegen`} lang="bash"   />
  </TabItem>
  <TabItem label="pnpm">
    <Code code={`pnpm codegen`} lang="bash"   />
  </TabItem>
</Tabs>


Then you will see the generated code in the `openapi` directory.

```bash
$ tree openapi
openapi/
├── queries
│   ├── common.ts
│   ├── ensureQueryData.ts
│   ├── index.ts
│   ├── infiniteQueries.ts
│   ├── prefetch.ts
│   ├── queries.ts
│   ├── router.ts
│   └── suspense.ts
└── requests
    ├── index.ts
    ├── schemas.gen.ts
    ├── services.gen.ts
    └── types.gen.ts
```

Before using the generated hooks, you need to install the required dependencies.

<Tabs>
  <TabItem label="npm">
    <Code code={`npm install @tanstack/react-query`} lang="bash"   />
  </TabItem>
  <TabItem label="yarn">
    <Code code={`yarn add @tanstack/react-query`} lang="bash"   />
  </TabItem>
  <TabItem label="pnpm">
    <Code code={`pnpm add @tanstack/react-query`} lang="bash"   />
  </TabItem>
</Tabs>

Then, add the `QueryClientProvider` to your application's entry point.

Also, you can set the base URL and interceptors for the client generated by `@hey-api/openapi-ts`.

```tsx
// src/main.tsx
import React from "react";
import ReactDOM from "react-dom/client";
import App from "./App";
import { QueryClientProvider, QueryClient } from "@tanstack/react-query";
import { client } from "../openapi/requests/services.gen";

client.setConfig({
  baseUrl: "YOUR_BASE_URL",
  throwOnError: true, // If you want to handle errors on `onError` callback of `useQuery` and `useMutation`, set this to `true`
});

client.interceptors.request.use((config) => {
  // Add your request interceptor logic here
  return config;
});

client.interceptors.response.use((response) => {
  // Add your response interceptor logic here
  return response;
});

export const queryClient = new QueryClient();

ReactDOM.createRoot(document.getElementById("root") as HTMLElement).render(
  <React.StrictMode>
    <QueryClientProvider client={queryClient}>
      <App />
    </QueryClientProvider>
  </React.StrictMode>
);
```

In your React application, you can import the generated hooks and use them like this:

```tsx
// src/App.tsx
import { useFindPets } from "../openapi/queries";

function App() {
  const { data, error, refetch } = useFindPets();

  if (error)
    return (
      <div>
        <p>Failed to fetch pets</p>
        <button type="button" onClick={() => refetch()}>
          Retry
        </button>
      </div>
    );

  return (
    <>
      <h1>Pet List</h1>
      <ul>{data?.map((pet) => <li key={pet.id}>{pet.name}</li>)}</ul>
    </>
  );
}

export default App;

```

## Output directory structure

<FileTree>

- openapi
  - queries
    - index.ts Main file that exports common types, variables, and queries. Does not export suspense or prefetch hooks
    - common.ts Common types
    - ensureQueryData.ts Generated ensureQueryData functions
    - queries.ts Generated query/mutation hooks
    - infiniteQueries.ts Generated infinite query hooks
    - suspense.ts Generated suspense hooks
    - prefetch.ts Generated prefetch functions
    - router.ts Generated loader factories and helpers for TanStack Router
  - requests Output code generated by `@hey-api/openapi-ts`

</FileTree>

To learn more about `prefetchQuery` and `ensureQueryData` functions, check out the following links:

- [Prefetching & Router Integration](https://tanstack.com/query/latest/docs/framework/react/guides/prefetching)
- [Server Rendering & Hydration](https://tanstack.com/query/latest/docs/framework/react/guides/ssr)
- [Advanced Server Rendering](https://tanstack.com/query/latest/docs/framework/react/guides/advanced-ssr)


